
07/02/14

on behalf of the NXT InfraStructure fund
 
l8orre@yandex.com
nxtforum.org



The Bridge - access the NXT blockchain using legacy bitcoind jsonrpc calls
 
purpose: communicate with the NXT blockchain by using bitcoind jsonrpc calls
 


operation: 

 

run bitcoind with rpc enabled
run NRS (NXT server)
run nxtBridge.py [args]

args: [ testNet/mainNet, filename for wallet.dat, ...]



1:
-------------------------------------
bitcoind can be used as a relay to forward jsonrpc calls that are sent to it to another port:

./bitcoind -rpcport=7879 getinfo 

Calls bitcoind from the command line with 'getinfo', and bitcoind forwards the 'getinfo' jsonrpc call to port 7879

Note: bitcoind is listening on the rpcport as designated in bitcoin.conf, default is 8332

sending 'getinfo' as jsonrpc to port 8332 does the same as the cmd line in the example above.


2:
-------------------------------------
nxtBridge listens on port 7879 for jsonrpc calls that are relayed to there form bitcoind

nxtBridge receives a jsonrpc call from bitcoind.

nxtBridge internally maps the jsonrpc call from bitcoind to associated NXT api call(s)

nxtBridge queries the designated NRS instance - currently hardcoded running on the same machine as the bridge,
but can be easily modified

nxtBridge receives the replie(s) from the NRS and maps them back to a format that is congruent to bitcoind

nxtBridge returns the bitcoind-'congruent' message
   


-------------------------------------
 
Example using shell call to bitcoind:

Alice@myBox:~/bitcoin-0.9.1-linux/bin/64$./bitcoind -rpcport=7879 getinfo
{
    "connections" : 56,
    "errors" : "",
    "balance" : 0.00000000,
    "keypoololdest" : 769654784,
    "keypoolsize" : 326764176,
    "proxy" : "",
    "version" : "1.2.0e",
    "timeoffset" : 0,
    "paytxfee" : 0.00000000,
    "protocolversion" : "1.2.0e",
    "blocks" : 142754,
    "walletversion" : "1.2.0e",
    "difficulty" : "2552571948492161",
    "testnet" : false
}

This call contains data from the NXT blockchain, and is returned by the Bridge via bitcoind.
The parameters returned represent the NXT blockchain.

Note the differences of values to current bitcoin blockchain parameters.


Dependencies:

Python3
PyQt4
requests
Werkzeug
jsonrpc
numpy



The following bitcoind jsonrpc calls will be supported:

getbalance		# under revision
getbestblockhash	# OK
getblock		# OK
getblockcount		# OK
getblockhash		# OK
getconnectioncount	# OK
getinfo			# OK
getnewaddress		# under revision
getreceivedbyaccount	# under revision
getreceivedbyaddress	# under revision
listsinceblock		# under revision
listunspent		# under revision
gettransaction		# OK
sendfrom		# under revision
sendtoaddress		# under revision
settxfee		# OK (n/a)
validateaddress		# OK



Note: 

NXT does not have a 'wallet' feature, the Bridge emulates a wallet-like database.
The Bridge internally maintains an sqlite3 database to do this.
Recommended handling of cryptographic keys will be documented in an upcoming version. 



Below are examples for the implemented bitcoind calls using the curl tool, given with two different parameter syntaxes.
These have been tested on Ubuntu13.10



some examples using bitcoind as jsonrpc relay:
----------------------------------
 
./bitcoind -rpcport=7879 getbalance 2865886802744497404 1

./bitcoind -rpcport=7879 getconnectioncount

./bitcoind -rpcport=7879 getinfo

./bitcoind -rpcport=7879 getreceivedbyaccount 2865886802744497404

./bitcoind -rpcport=7879 getreceivedbyaddress 2865886802744497404

./bitcoind -rpcport=7879 gettransaction 1448848043607985937

./bitcoind -rpcport=7879 sendfrom XXXXXXXXXXXXXXXX 16159101027034403504 1.2340 1 comm1 commTo 

./bitcoind -rpcport=7879 settxfee

./bitcoind -rpcport=7879 validateaddress XXXXXXXXXXXXXXXX



Note: 
bitcoind uses malformed jsonrpc with several of its api calls. The 'curl' tool is not able to hanlde this.
The Bridge might support this in the future also, but not at present.
 
 

Donations Welcome! NXT-LHVV-9ES7-RVHU-3R7HG

Comments, Questions: l8orre - nxtforum.org 





